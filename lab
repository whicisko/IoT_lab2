from sense_emu import SenseHat
import time

sense = SenseHat()

# Funkcja do odczytu danych z sensorów
def read_sensors():
    accelerometer = sense.get_accelerometer_raw()
    gyro = sense.get_gyroscope_raw()
    magnetometer = sense.get_compass_raw()
    temperature = sense.get_temperature()
    humidity = sense.get_humidity()
    pressure = sense.get_pressure()
    joystick = sense.stick.get_events()

    return {
        "accelerometer": accelerometer,
        "gyroscope": gyro,
        "magnetometer": magnetometer,
        "temperature": temperature,
        "humidity": humidity,
        "pressure": pressure,
        "joystick": joystick
    }

# Funkcja do sterowania wyświetlaczem LED
def control_led():
    sense.show_message("Hello, Raspberry Pi!")

# Główna pętla programu
try:
    while True:
        sensor_data = read_sensors()
        
        # Wyświetlanie danych z sensorów
        print("Accelerometer:", sensor_data["accelerometer"])
        print("Gyroscope:", sensor_data["gyroscope"])
        print("Magnetometer:", sensor_data["magnetometer"])
        print("Temperature:", sensor_data["temperature"])
        print("Humidity:", sensor_data["humidity"])
        print("Pressure:", sensor_data["pressure"])
        print("Joystick:", sensor_data["joystick"])

        # Sterowanie wyświetlaczem LED po wciśnięciu joysticka
        for event in sensor_data["joystick"]:
            if event.action == "pressed":
                control_led()

        time.sleep(1)

except KeyboardInterrupt:
    print("Program został przerwany.")
finally:
    sense.clear()
